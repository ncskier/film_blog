{% comment %}
  Input:
    - pageTag: tag for each page
    - previewType: [type] of (default, image, trailer)
{% endcomment %}

<ul class="post-list">

  {% for post in site.posts %}

    {% assign onPage = false %}

    {% if include.pageTag %}

      {% comment %} Check if post has a tag matching one of page tags {% endcomment %}
      {% for postTag in post.tags %}

        {% if include.pageTag == postTag %}
          {% assign onPage = true %}
        {% endif %}

      {% endfor %}

    {% else %}

      {% comment %} No page tag {% endcomment %}
      {% assign onPage = true %}

    {% endif %}

    {% if onPage %}
      <li>
        {% include post-preview.html post=post type=include.previewType %}
        {% comment %}
        {% assign date_format = site.minima.date_format | default: "%b %-d, %Y" %}
        <span class="post-meta">{{ post.date | date: date_format }}</span>

        <h2>
          <a class="post-link" href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
        </h2>
        {% endcomment %}
      </li>
    {% endif %}

  {% endfor %}
</ul>
